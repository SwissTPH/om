{% extends "ts_om/base.html" %}

{% block extra_js %}
    {{ block.super }}
	<script>
		var sim_group_status_link = "{% url "ts_om.run_status" experiment_id run_type %}";
		var sims = {{ sims|safe }};
	</script>
	<script src="{{ STATIC_URL }}ts_om_experiment/js/run.js"></script>
{% endblock %}

{% block right_content %}
  {% block page_content %}
    <h3>{% if run_type == 'run' %}Simulation{% else %}Test Run{% endif %} in progress</h3>
	  <div class="progress" id="run-progress" style="width: 40%;">
			<div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0"
                 aria-valuemax="100" style="min-width: 2em;">
                <div class="run-percent">0%</div>
                <span class="sr-only">0% Complete</span>
            </div>
		</div>
	  <div class="scenario-progress-count">
			<div id="finished-runs-count" style="float: left;">0</div>/{{ sims|length }} test runs complete.
	  </div>
	  <form method="post">{% csrf_token %}
			<label for="id_title">
					Experiment: <strong>{{ name }}</strong>
			</label>
{#	  	<div class="pull-right">#}
{#	  		<a class="btn" id="viz-results" style="display: none;" target="_blank" href="/ts_om_viz/sim/group/{{ group_id }}/">Visualize Results</a>#}
{#			</div>#}
			<p>
				This experiment contains {{ sims|length }} scenario{{ sims|pluralize }}.
			</p>
			<table class="table" style="display: none;">
				<thead>
					<tr></tr>
					<tr>
						<th>Name</th>
						<th>Status</th>
					</tr>
				</thead>
				<tbody>
					{% for s in sims %}
						{% if s == "done" %}
						<tr class="{% if s == "done" %}success{% else %}{% endif %}">
							<td>
							</td>
							<td>
								Finished
							</td>
						</tr>
						{% endif %}
						<div id="row-skeleton" style="display: none;">
							<tr class="{% if s == "done" %}success{% else %}{% endif %}">
								<td>
								</td>
								<td>
									Finished
								</td>
							</tr>
						</div>
				{% endfor %}
				</tbody>
			</table>
			<label class="checkbox">
				<input type="checkbox" disabled />
				Notify me by email when simulation is completed
			</label>
			<div class="form-actions">
				{% if status == 0 %}
					<input class="btn btn-primary" type="submit" value="Run Experiment" disabled>
				{% else %}
					<input class="btn btn-danger" type="submit" value="Delete Experiment" disabled>
				{% endif %}
				<a download="{{ name }}.zip" class="btn btn-default" id="download-experiment"
				   href="{% url "ts_om.download_experiment" experiment_id run_type %}">
					<i class="icon-download-alt"></i> Download experiment
				</a>
				<button class="btn btn-default disabled" disabled>Go to Experiment Creator</button>
			</div>
    </form>
	{% endblock %}
{% endblock %}
